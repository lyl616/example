<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=1XjLLEhZhQNUzd93EjU5nOGQ"></script>
    <!--<script type="text/javascript" src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"></script>-->
    <script type="text/javascript" src="../js/Heatmap_min.js"></script>
    <title>热力图功能示例</title>
    <style type="text/css">
        ul, li {
            list-style: none;
            margin: 0;
            padding: 0;
            float: left;
        }

        html {
            height: 100%
        }

        body {
            height: 100%;
            margin: 0px;
            padding: 0px;
            font-family: "微软雅黑";
        }

        #container {
            height: 500px;
            width: 100%;
        }

        #r-result {
            width: 100%;
        }
    </style>
</head>
<body>
<div id="container"></div>
<div id="r-result">
    <input type="button" onclick="openHeatmap();" value="显示热力图"/>
    <input type="button" onclick="closeHeatmap();" value="关闭热力图"/>
</div>
</body>
</html>
<script type="text/javascript">
    var map = new BMap.Map("container");          // 创建地图实例
    //    var point = new BMap.Point(116.418261, 39.921984);
    //    map.centerAndZoom(point, 15);


    //    map.centerAndZoom("济宁", 12);

    var point = new BMap.Point(116.59069, 35.417327);
    map.centerAndZoom(point, 11);
    // 初始化地图，设置中心点坐标和地图级别
    map.enableScrollWheelZoom(); // 允许滚轮缩放


    var points = [{"lng": 116.63774, "lat": 35.419693, "count": 400}, {
        "lng": 116.39174,
        "lat": 35.35866,
        "count": 400
    }, {"lng": 116.60487, "lat": 35.42717, "count": 400}, {
        "lng": 116.604866,
        "lat": 35.41505,
        "count": 396
    }, {"lng": 116.64776, "lat": 35.42925, "count": 400}, {
        "lng": 116.55086,
        "lat": 35.413124,
        "count": 400
    }, {"lng": 116.384476, "lat": 35.366238, "count": 400}, {
        "lng": 116.797264,
        "lat": 35.485874,
        "count": 267
    }, {"lng": 117.077545, "lat": 35.60244, "count": 400}, {
        "lng": 116.72349,
        "lat": 35.404354,
        "count": 381
    }, {"lng": 116.80949, "lat": 35.581932, "count": 245}, {
        "lng": 116.96724,
        "lat": 35.37738,
        "count": 359
    }, {"lng": 116.65407, "lat": 35.28856, "count": 306}, {
        "lng": 116.318565,
        "lat": 35.385586,
        "count": 329
    }, {"lng": 116.8857, "lat": 35.429504, "count": 500}, {
        "lng": 116.42746,
        "lat": 35.3771,
        "count": 315
    }, {"lng": 116.95643, "lat": 35.377804, "count": 341}, {
        "lng": 116.79383,
        "lat": 35.568024,
        "count": 318
    }, {"lng": 116.666016, "lat": 35.45777, "count": 314}, {
        "lng": 116.71809,
        "lat": 35.393993,
        "count": 500
    }, {"lng": 116.65842, "lat": 35.438328, "count": 349}, {
        "lng": 116.94283,
        "lat": 35.29485,
        "count": 301
    }, {"lng": 116.68417, "lat": 35.458332, "count": 400}, {
        "lng": 117.10248,
        "lat": 35.617466,
        "count": 281
    }, {"lng": 116.79264, "lat": 35.316986, "count": 338}, {
        "lng": 116.47768,
        "lat": 35.376804,
        "count": 340
    }, {"lng": 116.55692, "lat": 35.382267, "count": 228}, {
        "lng": 116.70859,
        "lat": 35.453075,
        "count": 328
    }, {"lng": 116.611885, "lat": 35.37822, "count": 396}, {
        "lng": 116.965675,
        "lat": 35.450733,
        "count": 296
    }, {"lng": 116.5505, "lat": 35.401497, "count": 311}, {
        "lng": 116.89766,
        "lat": 35.31508,
        "count": 400
    }, {"lng": 116.683205, "lat": 35.448807, "count": 400}, {
        "lng": 116.5991,
        "lat": 35.452534,
        "count": 318
    }, {"lng": 116.60238, "lat": 35.46618, "count": 339}, {
        "lng": 116.64142,
        "lat": 35.441185,
        "count": 344
    }, {"lng": 116.95763, "lat": 35.299065, "count": 314}, {
        "lng": 116.955376,
        "lat": 35.384502,
        "count": 321
    }, {"lng": 116.593925, "lat": 35.45278, "count": 271}, {
        "lng": 116.441124,
        "lat": 35.40184,
        "count": 500
    }, {"lng": 116.82084, "lat": 35.44956, "count": 350}, {
        "lng": 116.91163,
        "lat": 35.27409,
        "count": 331
    }, {"lng": 116.96835, "lat": 35.37909, "count": 334}, {
        "lng": 116.59108,
        "lat": 35.415237,
        "count": 331
    }, {"lng": 116.709564, "lat": 35.38294, "count": 374}, {
        "lng": 116.90352,
        "lat": 35.38765,
        "count": 308
    }, {"lng": 116.58135, "lat": 35.409054, "count": 346}, {
        "lng": 116.916565,
        "lat": 35.43724,
        "count": 360
    }, {"lng": 116.72528, "lat": 35.445354, "count": 299}, {
        "lng": 116.6063,
        "lat": 35.440197,
        "count": 359
    }, {"lng": 116.68507, "lat": 35.391136, "count": 238}, {
        "lng": 116.8516,
        "lat": 35.35974,
        "count": 341
    }, {"lng": 116.59438, "lat": 35.438274, "count": 342}, {
        "lng": 116.93227,
        "lat": 35.6097,
        "count": 382
    }, {"lng": 116.58945, "lat": 35.472313, "count": 352}, {
        "lng": 116.80474,
        "lat": 35.574123,
        "count": 305
    }, {"lng": 116.45128, "lat": 35.485542, "count": 159}, {
        "lng": 116.61804,
        "lat": 35.4219,
        "count": 360
    }, {"lng": 116.95443, "lat": 35.608353, "count": 302}, {
        "lng": 116.558815,
        "lat": 35.429108,
        "count": 379
    }, {"lng": 116.61386, "lat": 35.37229, "count": 379}, {
        "lng": 116.34923,
        "lat": 35.380432,
        "count": 400
    }, {"lng": 116.96704, "lat": 35.451218, "count": 294}, {
        "lng": 116.626076,
        "lat": 35.446934,
        "count": 384
    }, {"lng": 116.80398, "lat": 35.531624, "count": 318}, {
        "lng": 116.602455,
        "lat": 35.468773,
        "count": 343
    }, {"lng": 116.3488, "lat": 35.377773, "count": 346}, {
        "lng": 116.38436,
        "lat": 35.363102,
        "count": 394
    }, {"lng": 116.68375, "lat": 35.3679, "count": 288}, {
        "lng": 116.66465,
        "lat": 35.43204,
        "count": 400
    }, {"lng": 116.60471, "lat": 35.390823, "count": 352}, {
        "lng": 116.39388,
        "lat": 35.35909,
        "count": 260
    }, {"lng": 116.63515, "lat": 35.45516, "count": 355}, {
        "lng": 116.56446,
        "lat": 35.4186,
        "count": 383
    }, {"lng": 116.598595, "lat": 35.401268, "count": 336}, {
        "lng": 116.765495,
        "lat": 35.319923,
        "count": 169
    }, {"lng": 116.7805, "lat": 35.590775, "count": 325}, {
        "lng": 116.55033,
        "lat": 35.42258,
        "count": 315
    }, {"lng": 116.583954, "lat": 35.378735, "count": 395}, {
        "lng": 116.89646,
        "lat": 35.360954,
        "count": 358
    }, {"lng": 116.81525, "lat": 35.553345, "count": 311}, {
        "lng": 116.57276,
        "lat": 35.452553,
        "count": 400
    }, {"lng": 116.80414, "lat": 35.317055, "count": 341}, {
        "lng": 116.88599,
        "lat": 35.350754,
        "count": 327
    }, {"lng": 116.59898, "lat": 35.432034, "count": 333}, {
        "lng": 116.33057,
        "lat": 35.371765,
        "count": 400
    }, {"lng": 116.608604, "lat": 35.38322, "count": 328}, {
        "lng": 116.61735,
        "lat": 35.43557,
        "count": 360
    }, {"lng": 116.57487, "lat": 35.41997, "count": 351}, {
        "lng": 116.61083,
        "lat": 35.372368,
        "count": 347
    }, {"lng": 117.08183, "lat": 35.62172, "count": 331}, {
        "lng": 116.93618,
        "lat": 35.623356,
        "count": 296
    }, {"lng": 116.68975, "lat": 35.40182, "count": 354}, {
        "lng": 116.81273,
        "lat": 35.529037,
        "count": 359
    }, {"lng": 116.864944, "lat": 35.41396, "count": 369}, {
        "lng": 116.627304,
        "lat": 35.447033,
        "count": 270
    }, {"lng": 116.59719, "lat": 35.384953, "count": 224}, {
        "lng": 116.83113,
        "lat": 35.407333,
        "count": 329
    }, {"lng": 116.84403, "lat": 35.394234, "count": 396}, {
        "lng": 116.69564,
        "lat": 35.413177,
        "count": 350
    }, {"lng": 116.57288, "lat": 35.404606, "count": 364}, {
        "lng": 116.679955,
        "lat": 35.26967,
        "count": 301
    }, {"lng": 116.94356, "lat": 35.44943, "count": 295}, {
        "lng": 116.92559,
        "lat": 35.443424,
        "count": 273
    }, {"lng": 116.76819, "lat": 35.341415, "count": 333}, {
        "lng": 116.66383,
        "lat": 35.426834,
        "count": 100
    }, {"lng": 116.57197, "lat": 35.42461, "count": 100}, {
        "lng": 116.477234,
        "lat": 35.432358,
        "count": 100
    }, {"lng": 116.533806, "lat": 35.37005, "count": 50}, {
        "lng": 116.577194,
        "lat": 35.36278,
        "count": 100
    }, {"lng": 116.780304, "lat": 35.411797, "count": 100}, {
        "lng": 116.59292,
        "lat": 35.43034,
        "count": 100
    }, {"lng": 116.59519, "lat": 35.419327, "count": 202}, {
        "lng": 116.59289,
        "lat": 35.393307,
        "count": 100
    }, {"lng": 116.50103, "lat": 35.416058, "count": 50}, {
        "lng": 116.5899,
        "lat": 35.35356,
        "count": 100
    }, {"lng": 116.46307, "lat": 35.344852, "count": 50}, {
        "lng": 116.53681,
        "lat": 35.3523,
        "count": 100
    }, {"lng": 116.62773, "lat": 35.388725, "count": 100}, {
        "lng": 116.54883,
        "lat": 35.482716,
        "count": 50
    }, {"lng": 116.593895, "lat": 35.40922, "count": 100}, {
        "lng": 116.66079,
        "lat": 35.409748,
        "count": 50
    }, {"lng": 116.5199, "lat": 35.444565, "count": 100}, {
        "lng": 116.5053,
        "lat": 35.467445,
        "count": 50
    }, {"lng": 116.609825, "lat": 35.395008, "count": 229}, {
        "lng": 116.590775,
        "lat": 35.36748,
        "count": 100
    }, {"lng": 116.60223, "lat": 35.43498, "count": 100}, {
        "lng": 116.60223,
        "lat": 35.43498,
        "count": 100
    }, {"lng": 116.5729, "lat": 35.49387, "count": 220}, {
        "lng": 116.57092,
        "lat": 35.43056,
        "count": 150
    }, {"lng": 116.5849, "lat": 35.39579, "count": 100}, {
        "lng": 116.58689,
        "lat": 35.38518,
        "count": 100
    }, {"lng": 116.5799, "lat": 35.40133, "count": 150}, {
        "lng": 116.59887,
        "lat": 35.40296,
        "count": 50
    }, {"lng": 116.65333, "lat": 35.393787, "count": 50}, {
        "lng": 116.58293,
        "lat": 35.44135,
        "count": 50
    }, {"lng": 116.616295, "lat": 35.426205, "count": 100}, {
        "lng": 116.59487,
        "lat": 35.37249,
        "count": 100
    }, {"lng": 116.605835, "lat": 35.371426, "count": 100}, {
        "lng": 116.56588,
        "lat": 35.35247,
        "count": 100
    }, {"lng": 116.68344, "lat": 35.526783, "count": 50}, {
        "lng": 116.6208,
        "lat": 35.427643,
        "count": 150
    }, {"lng": 116.63274, "lat": 35.403515, "count": 100}, {
        "lng": 116.66886,
        "lat": 35.326977,
        "count": 150
    }, {"lng": 116.66886, "lat": 35.326977, "count": 150}, {
        "lng": 116.57889,
        "lat": 35.369507,
        "count": 100
    }, {"lng": 116.53184, "lat": 35.466846, "count": 100}, {
        "lng": 116.58393,
        "lat": 35.432133,
        "count": 150
    }, {"lng": 116.59888, "lat": 35.50984, "count": 100}, {
        "lng": 116.54883,
        "lat": 35.49852,
        "count": 50
    }, {"lng": 116.6638, "lat": 35.3944, "count": 100}, {
        "lng": 116.64071,
        "lat": 35.395782,
        "count": 100
    }, {"lng": 116.60485, "lat": 35.40104, "count": 100}, {
        "lng": 116.608864,
        "lat": 35.434036,
        "count": 150
    }, {"lng": 116.54986, "lat": 35.44357, "count": 100}, {
        "lng": 116.58692,
        "lat": 35.421623,
        "count": 100
    }, {"lng": 116.57491, "lat": 35.409885, "count": 150}, {
        "lng": 116.48395,
        "lat": 35.447025,
        "count": 100
    }, {"lng": 116.49902, "lat": 35.393497, "count": 50}, {
        "lng": 116.39412,
        "lat": 35.359135,
        "count": 50
    }, {"lng": 116.57006, "lat": 35.296196, "count": 50}, {
        "lng": 116.616806,
        "lat": 35.41996,
        "count": 100
    }, {"lng": 116.590645, "lat": 35.405994, "count": 50}, {
        "lng": 116.571976,
        "lat": 35.382748,
        "count": 100
    }, {"lng": 116.5769, "lat": 35.392044, "count": 100}, {
        "lng": 116.61281,
        "lat": 35.393364,
        "count": 150
    }, {"lng": 116.52483, "lat": 35.385414, "count": 50}, {
        "lng": 116.52483,
        "lat": 35.385414,
        "count": 50
    }, {"lng": 116.5629, "lat": 35.43591, "count": 100}, {
        "lng": 116.60387,
        "lat": 35.40583,
        "count": 50
    }, {"lng": 116.57159, "lat": 35.410557, "count": 150}, {
        "lng": 116.57992,
        "lat": 35.410744,
        "count": 100
    }, {"lng": 116.583885, "lat": 35.374973, "count": 100}, {
        "lng": 116.62875,
        "lat": 35.419174,
        "count": 100
    }, {"lng": 116.5959, "lat": 35.41475, "count": 100}, {
        "lng": 116.58742,
        "lat": 35.431744,
        "count": 150
    }, {"lng": 116.60885, "lat": 35.419617, "count": 150}, {"lng": 116.61779, "lat": 35.409573, "count": 100}];
    var pointsw = [
        {"lng": 116.418261, "lat": 39.921984, "count": 50},
        {"lng": 116.423332, "lat": 39.916532, "count": 51},
        {"lng": 116.419787, "lat": 39.930658, "count": 15},
        {"lng": 116.418455, "lat": 39.920921, "count": 40},
        {"lng": 116.418843, "lat": 39.915516, "count": 100},
        {"lng": 116.42546, "lat": 39.918503, "count": 6},
        {"lng": 116.423289, "lat": 39.919989, "count": 18},
        {"lng": 116.418162, "lat": 39.915051, "count": 80},
        {"lng": 116.422039, "lat": 39.91782, "count": 11},
        {"lng": 116.41387, "lat": 39.917253, "count": 7},
        {"lng": 116.41773, "lat": 39.919426, "count": 42},
        {"lng": 116.421107, "lat": 39.916445, "count": 4},
        {"lng": 116.417521, "lat": 39.917943, "count": 27},
        {"lng": 116.419812, "lat": 39.920836, "count": 23},
        {"lng": 116.420682, "lat": 39.91463, "count": 60},
        {"lng": 116.415424, "lat": 39.924675, "count": 8},
        {"lng": 116.419242, "lat": 39.914509, "count": 15},
        {"lng": 116.422766, "lat": 39.921408, "count": 25},
        {"lng": 116.421674, "lat": 39.924396, "count": 21},
        {"lng": 116.427268, "lat": 39.92267, "count": 1},
        {"lng": 116.417721, "lat": 39.920034, "count": 51},
        {"lng": 116.412456, "lat": 39.92667, "count": 7},
        {"lng": 116.420432, "lat": 39.919114, "count": 11},
        {"lng": 116.425013, "lat": 39.921611, "count": 35},
        {"lng": 116.418733, "lat": 39.931037, "count": 22},
        {"lng": 116.419336, "lat": 39.931134, "count": 4},
        {"lng": 116.413557, "lat": 39.923254, "count": 5},
        {"lng": 116.418367, "lat": 39.92943, "count": 3},
        {"lng": 116.424312, "lat": 39.919621, "count": 100},
        {"lng": 116.423874, "lat": 39.919447, "count": 87},
        {"lng": 116.424225, "lat": 39.923091, "count": 32},
        {"lng": 116.417801, "lat": 39.921854, "count": 44},
        {"lng": 116.417129, "lat": 39.928227, "count": 21},
        {"lng": 116.426426, "lat": 39.922286, "count": 80},
        {"lng": 116.421597, "lat": 39.91948, "count": 32},
        {"lng": 116.423895, "lat": 39.920787, "count": 26},
        {"lng": 116.423563, "lat": 39.921197, "count": 17},
        {"lng": 116.417982, "lat": 39.922547, "count": 17},
        {"lng": 116.426126, "lat": 39.921938, "count": 25},
        {"lng": 116.42326, "lat": 39.915782, "count": 100},
        {"lng": 116.419239, "lat": 39.916759, "count": 39},
        {"lng": 116.417185, "lat": 39.929123, "count": 11},
        {"lng": 116.417237, "lat": 39.927518, "count": 9},
        {"lng": 116.417784, "lat": 39.915754, "count": 47},
        {"lng": 116.420193, "lat": 39.917061, "count": 52},
        {"lng": 116.422735, "lat": 39.915619, "count": 100},
        {"lng": 116.418495, "lat": 39.915958, "count": 46},
        {"lng": 116.416292, "lat": 39.931166, "count": 9},
        {"lng": 116.419916, "lat": 39.924055, "count": 8},
        {"lng": 116.42189, "lat": 39.921308, "count": 11},
        {"lng": 116.413765, "lat": 39.929376, "count": 3},
        {"lng": 116.418232, "lat": 39.920348, "count": 50},
        {"lng": 116.417554, "lat": 39.930511, "count": 15},
        {"lng": 116.418568, "lat": 39.918161, "count": 23},
        {"lng": 116.413461, "lat": 39.926306, "count": 3},
        {"lng": 116.42232, "lat": 39.92161, "count": 13},
        {"lng": 116.4174, "lat": 39.928616, "count": 6},
        {"lng": 116.424679, "lat": 39.915499, "count": 21},
        {"lng": 116.42171, "lat": 39.915738, "count": 29},
        {"lng": 116.417836, "lat": 39.916998, "count": 99},
        {"lng": 116.420755, "lat": 39.928001, "count": 10},
        {"lng": 116.414077, "lat": 39.930655, "count": 14},
        {"lng": 116.426092, "lat": 39.922995, "count": 16},
        {"lng": 116.41535, "lat": 39.931054, "count": 15},
        {"lng": 116.413022, "lat": 39.921895, "count": 13},
        {"lng": 116.415551, "lat": 39.913373, "count": 17},
        {"lng": 116.421191, "lat": 39.926572, "count": 1},
        {"lng": 116.419612, "lat": 39.917119, "count": 9},
        {"lng": 116.418237, "lat": 39.921337, "count": 54},
        {"lng": 116.423776, "lat": 39.921919, "count": 26},
        {"lng": 116.417694, "lat": 39.92536, "count": 17},
        {"lng": 116.415377, "lat": 39.914137, "count": 19},
        {"lng": 116.417434, "lat": 39.914394, "count": 43},
        {"lng": 116.42588, "lat": 39.922622, "count": 27},
        {"lng": 116.418345, "lat": 39.919467, "count": 8},
        {"lng": 116.426883, "lat": 39.917171, "count": 3},
        {"lng": 116.423877, "lat": 39.916659, "count": 34},
        {"lng": 116.415712, "lat": 39.915613, "count": 14},
        {"lng": 116.419869, "lat": 39.931416, "count": 12},
        {"lng": 116.416956, "lat": 39.925377, "count": 11},
        {"lng": 116.42066, "lat": 39.925017, "count": 38},
        {"lng": 116.416244, "lat": 39.920215, "count": 91},
        {"lng": 116.41929, "lat": 39.915908, "count": 54},
        {"lng": 116.422116, "lat": 39.919658, "count": 21},
        {"lng": 116.4183, "lat": 39.925015, "count": 15},
        {"lng": 116.421969, "lat": 39.913527, "count": 3},
        {"lng": 116.422936, "lat": 39.921854, "count": 24},
        {"lng": 116.41905, "lat": 39.929217, "count": 12},
        {"lng": 116.424579, "lat": 39.914987, "count": 57},
        {"lng": 116.42076, "lat": 39.915251, "count": 70},
        {"lng": 116.425867, "lat": 39.918989, "count": 8}];

    if (!isSupportCanvas()) {
        alert('热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~')
    }
    //详细的参数,可以查看heatmap.js的文档 https://github.com/pa7/heatmap.js/blob/master/README.md
    //参数说明如下:
    /* visible 热力图是否显示,默认为true
     * opacity 热力的透明度,1-100
     * radius 势力图的每个点的半径大小
     * gradient  {JSON} 热力图的渐变区间 . gradient如下所示
     *	{
     .2:'rgb(0, 255, 255)',
     .5:'rgb(0, 110, 255)',
     .8:'rgb(100, 0, 255)'
     }
     其中 key 表示插值的位置, 0~1.
     value 为颜色值.
     */
    heatmapOverlay = new BMapLib.HeatmapOverlay({
        radius: 20,
        maxOpacity: 1,
        minOpacity: 0,
        blur: .60,
//        gradient: {
//            // enter n keys between 0 and 1 here
//            // for gradient color customization
////            '.5': 'blue',
////            '.8': 'red',
////            '.95': 'white'
//            '.0': '#00E500',
//            '.2': '#FFFF00',
//            '.4': '#FF7E00',
//            '.6': '#FF0000',
//            '.8': '#99004C',
//            '.98': '#7E0023'
//        }
    });
    map.addOverlay(heatmapOverlay);
    heatmapOverlay.setDataSet({data: points, max: 500});
    //是否显示热力图
    function openHeatmap() {
        heatmapOverlay.show();
    }
    function closeHeatmap() {
        heatmapOverlay.hide();
    }
    closeHeatmap();
    function setGradient() {
        /*格式如下所示:
         {
         0:'rgb(102, 255, 0)',
         .5:'rgb(255, 170, 0)',
         1:'rgb(255, 0, 0)'
         }*/
        var gradient = {};
        var colors = document.querySelectorAll("input[type='color']");
        colors = [].slice.call(colors, 0);
        colors.forEach(function (ele) {
            gradient[ele.getAttribute("data-key")] = ele.value;
        });
        heatmapOverlay.setOptions({"gradient": gradient});
    }
    //判断浏览区是否支持canvas
    function isSupportCanvas() {
        var elem = document.createElement('canvas');
        return !!(elem.getContext && elem.getContext('2d'));
    }
</script>