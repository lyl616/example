/*
 * Viewer v0.5.1
 * https://github.com/fengyuanchen/viewer
 *
 * Copyright (c) 2015-2016 Fengyuan Chen
 * Released under the MIT license
 *
 * Date: 2016-03-11T07:57:59.486Z
 */
(function(A){if(typeof define==="function"&&define.amd){define("viewer",["jquery"],A)}else{if(typeof exports==="object"){A(require("jquery"))}else{A(jQuery)}}})(function(f){var n=f(window);var K=f(document);var Y="viewer";var v=document.createElement(Y);var O="viewer-fixed";var A="viewer-open";var Q="viewer-show";var k="viewer-hide";var E="viewer-hide-xs-down";var R="viewer-hide-sm-down";var M="viewer-hide-md-down";var L="viewer-fade";var m="viewer-in";var a="viewer-move";var Ad="viewer-active";var Ae="viewer-invisible";var S="viewer-transition";var H="viewer-fullscreen";var G="viewer-fullscreen-exit";var N="viewer-close";var U="img";var I="mousedown touchstart pointerdown MSPointerDown";var V="mousemove touchmove pointermove MSPointerMove";var q="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel";var r="wheel mousewheel DOMMouseScroll";var d="transitionend";var C="load."+Y;var l="keydown."+Y;var w="click."+Y;var e="resize."+Y;var Ab="build."+Y;var W="built."+Y;var T="show."+Y;var Af="shown."+Y;var Ac="hide."+Y;var y="hidden."+Y;var Z="view."+Y;var s="viewed."+Y;var B=typeof v.style.transition!=="undefined";var z=Math.round;var u=Math.sqrt;var p=Math.abs;var F=Math.min;var Aa=Math.max;var D=Number;function o(Ag){return typeof Ag==="string"}function b(Ag){return typeof Ag==="number"&&!isNaN(Ag)}function t(Ag){return typeof Ag==="undefined"}function P(Ah,Ag){var Ai=[];if(b(Ag)){Ai.push(Ag)}return Ai.slice.apply(Ah,Ai)}function X(Ah,Ag){var Ai=P(arguments,2);return function(){return Ah.apply(Ag,Ai.concat(P(arguments)))}}function c(Ai){var Ak=[];var Ag=Ai.rotate;var Aj=Ai.scaleX;var Ah=Ai.scaleY;if(b(Ag)){Ak.push("rotate("+Ag+"deg)")}if(b(Aj)&&b(Ah)){Ak.push("scale("+Aj+","+Ah+")")}return Ak.length?Ak.join(" "):"none"}function J(Ag){return Ag.offsetWidth}function g(Ag){return o(Ag)?Ag.replace(/^.*\//,"").replace(/[\?&#].*$/,""):""}function x(Ah,Ag){var Ai;if(Ah.naturalWidth){return Ag(Ah.naturalWidth,Ah.naturalHeight)}Ai=document.createElement("img");Ai.onload=function(){Ag(this.width,this.height)};Ai.src=Ah.src}function i(Ah){var Ag=Ah.length;var Aj=0;var Ai=0;if(Ag){f.each(Ah,function(Ak,Al){Aj+=Al.pageX;Ai+=Al.pageY});Aj/=Ag;Ai/=Ag}return{pageX:Aj,pageY:Ai}}function j(Ag){switch(Ag){case 2:return E;case 3:return R;case 4:return M}}function h(Ah,Ag){this.$element=f(Ah);this.options=f.extend({},h.DEFAULTS,f.isPlainObject(Ag)&&Ag);this.isImg=false;this.isBuilt=false;this.isShown=false;this.isViewed=false;this.isFulled=false;this.isPlayed=false;this.wheeling=false;this.playing=false;this.fading=false;this.tooltiping=false;this.transitioning=false;this.action=false;this.target=false;this.timeout=false;this.index=0;this.length=0;this.init()}h.prototype={constructor:h,init:function(){var Aj=this.options;var Ai=this.$element;Aj.selectorImg?U=Aj.selectorImg:null;var Ak=Ai.is(U);var Ah=Ak?Ai:Ai.find(Aj.selectorImg);var Ag=Ah.length;var Al=f.proxy(this.ready,this);if(!Ag){return}if(f.isFunction(Aj.build)){Ai.one(Ab,Aj.build)}if(this.trigger(Ab).isDefaultPrevented()){return}if(!B){Aj.transition=false}this.isImg=Ak;this.length=Ag;this.count=0;this.$images=Ah;this.$body=f("body");if(Aj.inline){Ai.one(W,f.proxy(function(){this.view()},this));Ah.each(function(){if(this.complete){Al()}else{f(this).one(C,Al)}})}else{Ai.on(w,f.proxy(this.start,this))}},ready:function(){this.count++;if(this.count===this.length){this.build()}},build:function(){var Am=this.options;var An=this.$element;var Ag;var Ah;var Al;var Ak;var Ai;var Aj;if(this.isBuilt){return}this.$parent=Ag=An.parent();this.$viewer=Ah=f(h.TEMPLATE);this.$canvas=Ah.find(".viewer-canvas");this.$footer=Ah.find(".viewer-footer");this.$title=Al=Ah.find(".viewer-title");this.$toolbar=Ak=Ah.find(".viewer-toolbar");this.$navbar=Ai=Ah.find(".viewer-navbar");this.$button=Aj=Ah.find(".viewer-button");this.$tooltip=Ah.find(".viewer-tooltip");this.$player=Ah.find(".viewer-player");this.$list=Ah.find(".viewer-list");Al.addClass(!Am.title?k:j(Am.title));Ak.addClass(!Am.toolbar?k:j(Am.toolbar));Ak.find("li[class*=zoom]").toggleClass(Ae,!Am.zoomable);Ak.find("li[class*=flip]").toggleClass(Ae,!Am.scalable);if(!Am.rotatable){Ak.find("li[class*=rotate]").addClass(Ae).appendTo(Ak)}Ai.addClass(!Am.navbar?k:j(Am.navbar));Aj.toggleClass(k,!Am.button);if(Am.inline){Aj.addClass(H);Ah.css("z-index",Am.zIndexInline);if(Ag.css("position")==="static"){Ag.css("position","relative")}}else{Aj.addClass(N);Ah.css("z-index",Am.zIndex).addClass([O,L,k].join(" "))}f(Am.parentElement).append(Ah);if(Am.inline){this.render();this.bind();this.isShown=true}this.isBuilt=true;if(f.isFunction(Am.built)){An.one(W,Am.built)}this.trigger(W)},unbuild:function(){if(!this.isBuilt){return}this.isBuilt=false;this.$viewer.remove()},bind:function(){var Ah=this.options;var Ag=this.$element;if(f.isFunction(Ah.view)){Ag.on(Z,Ah.view)}if(f.isFunction(Ah.viewed)){Ag.on(s,Ah.viewed)}this.$viewer.on(w,f.proxy(this.click,this)).on(r,f.proxy(this.wheel,this));this.$canvas.on(I,f.proxy(this.mousedown,this));K.on(V,(this._mousemove=X(this.mousemove,this))).on(q,(this._mouseup=X(this.mouseup,this))).on(l,(this._keydown=X(this.keydown,this)));n.on(e,(this._resize=X(this.resize,this)))},unbind:function(){var Ah=this.options;var Ag=this.$element;if(f.isFunction(Ah.view)){Ag.off(Z,Ah.view)}if(f.isFunction(Ah.viewed)){Ag.off(s,Ah.viewed)}this.$viewer.off(w,this.click).off(r,this.wheel);this.$canvas.off(I,this.mousedown);K.off(V,this._mousemove).off(q,this._mouseup).off(l,this._keydown);n.off(e,this._resize)},render:function(){this.initContainer();this.initViewer();this.initList();this.renderViewer()},initContainer:function(){this.container={width:n.innerWidth(),height:n.innerHeight()}},initViewer:function(){var Ah=this.options;var Ag=this.$parent;var Ai;if(Ah.inline){this.parent=Ai={width:Aa(Ag.width(),Ah.minWidth),height:Aa(Ag.height(),Ah.minHeight)}}if(this.isFulled||!Ai){Ai=this.container}this.viewer=f.extend({},Ai)},renderViewer:function(){if(this.options.inline&&!this.isFulled){this.$viewer.css(this.viewer)}},initList:function(){var Ai=this.options;var Ah=this.$element;var Ag=this.$list;var Aj=[];this.$images.each(function(Ak){var An=this.src;var Am=this.alt||g(An);var Al=Ai.url;if(!An){return}if(o(Al)){Al=this.getAttribute(Al)}else{if(f.isFunction(Al)){Al=Al.call(this,this)}}Aj.push('<li><img src="'+An+'" data-action="view" data-index="'+Ak+'" data-original-url="'+(Al||An)+'" alt="'+Am+'"></li>')});Ag.html(Aj.join("")).find(U).one(C,{filled:true},f.proxy(this.loadImage,this));this.$items=Ag.children();if(Ai.transition){Ah.one(s,function(){Ag.addClass(S)})}},renderList:function(Ah){var Ag=Ah||this.index;var Ai=this.$items.eq(Ag).width();var Aj=Ai+1;this.$list.css({width:Aj*this.length,marginLeft:(this.viewer.width-Ai)/2-Aj*Ag})},resetList:function(){this.$list.empty().removeClass(S).css("margin-left",0)},initImage:function(Ag){var Al=this.options;var Ai=this.$image;var Aj=this.viewer;var Am=this.$footer.height();var Ak=Aj.width;var Ah=Aa(Aj.height-Am,Am);var An=this.image||{};x(Ai[0],f.proxy(function(As,Ar){var Aq=As/Ar;var At=Ak;var Ao=Ah;var Au;var Ap;if(Ah*Aq>Ak){Ao=Ak/Aq}else{At=Ah*Aq}At=F(At*0.9,As);Ao=F(Ao*0.9,Ar);Ap={naturalWidth:As,naturalHeight:Ar,aspectRatio:Aq,ratio:At/As,width:At,height:Ao,left:(Ak-At)/2,top:(Ah-Ao)/2};Au=f.extend({},Ap);if(Al.rotatable){Ap.rotate=An.rotate||0;Au.rotate=0}if(Al.scalable){Ap.scaleX=An.scaleX||1;Ap.scaleY=An.scaleY||1;Au.scaleX=1;Au.scaleY=1}this.image=Ap;this.initialImage=Au;if(f.isFunction(Ag)){Ag()}},this))},renderImage:function(Ag){var Ah=this.image;var Ai=this.$image;Ai.css({width:Ah.width,height:Ah.height,marginLeft:Ah.left,marginTop:Ah.top,transform:c(Ah)});if(f.isFunction(Ag)){if(this.transitioning){Ai.one(d,Ag)}else{Ag()}}},resetImage:function(){if(this.$image){this.$image.remove();this.$image=null}},start:function(Ag){var Ah=Ag.target;if(f(Ah).is(U)){this.target=Ah;this.show()}},click:function(Ah){var Aj=f(Ah.target);var Ag=Aj.data("action");var Ai=this.image;switch(Ag){case"mix":if(this.isPlayed){this.stop()}else{if(this.options.inline){if(this.isFulled){this.exit()}else{this.full()}}else{this.hide()}}break;case"view":this.view(Aj.data("index"));break;case"zoom-in":this.zoom(0.1,true);break;case"zoom-out":this.zoom(-0.1,true);break;case"one-to-one":this.toggle();break;case"reset":this.reset();break;case"prev":this.prev();break;case"play":this.play();break;case"next":this.next();break;case"rotate-left":this.rotate(-90);break;case"rotate-right":this.rotate(90);break;case"flip-horizontal":this.scaleX(-Ai.scaleX||-1);break;case"flip-vertical":this.scaleY(-Ai.scaleY||-1);break;default:if(this.isPlayed){this.stop()}}},load:function(){var Ag=this.options;var Ai=this.viewer;var Ah=this.$image;if(this.timeout){clearTimeout(this.timeout);this.timeout=false}Ah.removeClass(Ae).css("cssText",("width:0;height:0;margin-left:"+Ai.width/2+"px;margin-top:"+Ai.height/2+"px;max-width:none!important;visibility:visible;"));this.initImage(f.proxy(function(){Ah.toggleClass(S,Ag.transition).toggleClass(a,Ag.movable);this.renderImage(f.proxy(function(){this.isViewed=true;this.trigger(s)},this))},this))},loadImage:function(Ah){var Aj=Ah.target;var Ak=f(Aj);var Ag=Ak.parent();var Am=Ag.width();var Ai=Ag.height();var Al=Ah.data&&Ah.data.filled;x(Aj,function(Aq,Ap){var Ao=Aq/Ap;var Ar=Am;var An=Ai;if(Ai*Ao>Am){if(Al){Ar=Ai*Ao}else{An=Am/Ao}}else{if(Al){An=Am/Ao}else{Ar=Ai*Ao}}Ak.css({width:Ar,height:An,marginLeft:(Am-Ar)/2,marginTop:(Ai-An)/2})})},resize:function(){this.initContainer();this.initViewer();this.renderViewer();this.renderList();if(this.isViewed){this.initImage(f.proxy(function(){this.renderImage()},this))}if(this.isPlayed){this.$player.find(U).one(C,f.proxy(this.loadImage,this)).trigger(C)}},wheel:function(Aj){var Ah=Aj.originalEvent||Aj;var Ai=D(this.options.zoomRatio)||0.1;var Ag=1;if(!this.isViewed){return}Aj.preventDefault();if(this.wheeling){return}this.wheeling=true;setTimeout(f.proxy(function(){this.wheeling=false},this),50);if(Ah.deltaY){Ag=Ah.deltaY>0?1:-1}else{if(Ah.wheelDelta){Ag=-Ah.wheelDelta/120}else{if(Ah.detail){Ag=Ah.detail>0?1:-1}}}this.zoom(-Ag*Ai,true,Aj)},keydown:function(Ag){var Ah=this.options;var Ai=Ag.which;if(!this.isFulled||!Ah.keyboard){return}switch(Ai){case 27:if(this.isPlayed){this.stop()}else{if(Ah.inline){if(this.isFulled){this.exit()}}else{this.hide()}}break;case 32:if(this.isPlayed){this.stop()}break;case 37:this.prev();break;case 38:Ag.preventDefault();this.zoom(Ah.zoomRatio,true);break;case 39:this.next();break;case 40:Ag.preventDefault();this.zoom(-Ah.zoomRatio,true);break;case 48:case 49:if(Ag.ctrlKey||Ag.shiftKey){Ag.preventDefault();this.toggle()}break}},mousedown:function(Ak){var Aj=this.options;var Ah=Ak.originalEvent;var Am=Ah&&Ah.touches;var Ai=Ak;var Ag=Aj.movable?"move":false;var Al;if(!this.isViewed){return}if(Am){Al=Am.length;if(Al>1){if(Aj.zoomable&&Al===2){Ai=Am[1];this.startX2=Ai.pageX;this.startY2=Ai.pageY;Ag="zoom"}else{return}}else{if(this.isSwitchable()){Ag="switch"}}Ai=Am[0]}if(Ag){Ak.preventDefault();this.action=Ag;this.startX=Ai.pageX||Ah&&Ah.pageX;this.startY=Ai.pageY||Ah&&Ah.pageY}},mousemove:function(Ai){var Ak=this.options;var An=this.action;var Ah=this.$image;var Am=Ai.originalEvent;var Al=Am&&Am.touches;var Ag=Ai;var Aj;if(!this.isViewed){return}if(Al){Aj=Al.length;if(Aj>1){if(Ak.zoomable&&Aj===2){Ag=Al[1];this.endX2=Ag.pageX;this.endY2=Ag.pageY}else{return}}Ag=Al[0]}if(An){Ai.preventDefault();if(An==="move"&&Ak.transition&&Ah.hasClass(S)){Ah.removeClass(S)}this.endX=Ag.pageX||Am&&Am.pageX;this.endY=Ag.pageY||Am&&Am.pageY;this.change(Ai)}},mouseup:function(Ah){var Ag=this.action;if(Ag){Ah.preventDefault();if(Ag==="move"&&this.options.transition){this.$image.addClass(S)}this.action=false}},show:function(){var Ag=this.options;var Ah;if(Ag.inline||this.transitioning){return}if(!this.isBuilt){this.build()}if(f.isFunction(Ag.show)){this.$element.one(T,Ag.show)}if(this.trigger(T).isDefaultPrevented()){return}this.$body.addClass(A);Ah=this.$viewer.removeClass(k);this.$element.one(Af,f.proxy(function(){this.view(this.target?this.$images.index(this.target):this.index);this.target=false},this));if(Ag.transition){this.transitioning=true;Ah.addClass(S);J(Ah[0]);Ah.one(d,f.proxy(this.shown,this)).addClass(m)}else{Ah.addClass(m);this.shown()}},hide:function(){var Ag=this.options;var Ah=this.$viewer;if(Ag.inline||this.transitioning||!this.isShown){return}if(f.isFunction(Ag.hide)){this.$element.one(Ac,Ag.hide)}if(this.trigger(Ac).isDefaultPrevented()){return}if(this.isViewed&&Ag.transition){this.transitioning=true;this.$image.one(d,f.proxy(function(){Ah.one(d,f.proxy(this.hidden,this)).removeClass(m)},this));this.zoomTo(0,false,false,true)}else{Ah.removeClass(m);this.hidden()}},view:function(Al){var Ag=this.$title;var Ak;var Aj;var Am;var Ai;var Ah;Al=Number(Al)||0;if(!this.isShown||this.isPlayed||Al<0||Al>=this.length||this.isViewed&&Al===this.index){return}if(this.trigger(Z).isDefaultPrevented()){return}Aj=this.$items.eq(Al);Am=Aj.find("img");Ai=Am.data("originalUrl");Ah=Am.attr("alt");this.$image=Ak=f('<img src="'+Ai+'" alt="'+Ah+'">');if(this.isViewed){this.$items.eq(this.index).removeClass(Ad)}Aj.addClass(Ad);this.isViewed=false;this.index=Al;this.image=null;this.$canvas.html(Ak.addClass(Ae));this.renderList();Ag.empty();this.$element.one(s,f.proxy(function(){var Ao=this.image;var Ap=Ao.naturalWidth;var An=Ao.naturalHeight;Ag.html(Ah+" ("+Ap+" &times; "+An+")")},this));if(Ak[0].complete){this.load()}else{Ak.one(C,f.proxy(this.load,this));if(this.timeout){clearTimeout(this.timeout)}this.timeout=setTimeout(f.proxy(function(){Ak.removeClass(Ae);this.timeout=false},this),1000)}},prev:function(){this.view(Aa(this.index-1,0))},next:function(){this.view(F(this.index+1,this.length-1))},move:function(Ag,Ah){var Ai=this.image;this.moveTo(t(Ag)?Ag:Ai.left+D(Ag),t(Ah)?Ah:Ai.top+D(Ah))},moveTo:function(Ah,Ai){var Ag=this.image;var Aj=false;if(t(Ai)){Ai=Ah}Ah=D(Ah);Ai=D(Ai);if(this.isViewed&&!this.isPlayed&&this.options.movable){if(b(Ah)){Ag.left=Ah;Aj=true}if(b(Ai)){Ag.top=Ai;Aj=true}if(Aj){this.renderImage()}}},zoom:function(Ah,Aj,Ag){var Ai=this.image;Ah=D(Ah);if(Ah<0){Ah=1/(1-Ah)}else{Ah=1+Ah}this.zoomTo(Ai.width*Ah/Ai.naturalWidth,Aj,Ag)},zoomTo:function(Ai,Ah,At,An){var Ao=this.options;var Au=0.01;var Aq=100;var As=this.image;var Ap=As.width;var Aj=As.height;var Ar;var Ak;var Am;var Al;var Ag;Ai=Aa(0,Ai);if(b(Ai)&&this.isViewed&&!this.isPlayed&&(An||Ao.zoomable)){if(!An){Au=Aa(Au,Ao.minZoomRatio);Aq=F(Aq,Ao.maxZoomRatio);Ai=F(Aa(Ai,Au),Aq)}if(Ai>0.95&&Ai<1.05){Ai=1}Ak=As.naturalWidth*Ai;Am=As.naturalHeight*Ai;if(At&&(Ar=At.originalEvent)){Al=this.$viewer.offset();Ag=Ar.touches?i(Ar.touches):{pageX:At.pageX||Ar.pageX||0,pageY:At.pageY||Ar.pageY||0};As.left-=(Ak-Ap)*(((Ag.pageX-Al.left)-As.left)/Ap);As.top-=(Am-Aj)*(((Ag.pageY-Al.top)-As.top)/Aj)}else{As.left-=(Ak-Ap)/2;As.top-=(Am-Aj)/2}As.width=Ak;As.height=Am;As.ratio=Ai;this.renderImage();if(Ah){this.tooltip()}}},rotate:function(Ag){this.rotateTo((this.image.rotate||0)+D(Ag))},rotateTo:function(Ah){var Ag=this.image;Ah=D(Ah);if(b(Ah)&&this.isViewed&&!this.isPlayed&&this.options.rotatable){Ag.rotate=Ah;this.renderImage()}},scale:function(Ah,Ag){var Ai=this.image;var Aj=false;if(t(Ag)){Ag=Ah}Ah=D(Ah);Ag=D(Ag);if(this.isViewed&&!this.isPlayed&&this.options.scalable){if(b(Ah)){Ai.scaleX=Ah;Aj=true}if(b(Ag)){Ai.scaleY=Ag;Aj=true}if(Aj){this.renderImage()}}},scaleX:function(Ag){this.scale(Ag,this.image.scaleY)},scaleY:function(Ag){this.scale(this.image.scaleX,Ag)},play:function(){var Ai=this.options;var Ah=this.$player;var Ak=f.proxy(this.loadImage,this);var Aj=[];var Ag=0;var Am=0;var Al;if(!this.isShown||this.isPlayed){return}if(Ai.fullscreen){this.requestFullscreen()}this.isPlayed=true;Ah.addClass(Q);this.$items.each(function(An){var Ao=f(this);var Aq=Ao.find("img");var Ap=f('<img src="'+Aq.data("originalUrl")+'" alt="'+Aq.attr("alt")+'">');Ag++;Ap.addClass(L).toggleClass(S,Ai.transition);if(Ao.hasClass(Ad)){Ap.addClass(m);Am=An}Aj.push(Ap);Ap.one(C,{filled:false},Ak);Ah.append(Ap)});if(b(Ai.interval)&&Ai.interval>0){Al=f.proxy(function(){this.playing=setTimeout(function(){Aj[Am].removeClass(m);Am++;Am=Am<Ag?Am:0;Aj[Am].addClass(m);Al()},Ai.interval)},this);if(Ag>1){Al()}}},stop:function(){if(!this.isPlayed){return}if(this.options.fullscreen){this.exitFullscreen()}this.isPlayed=false;clearTimeout(this.playing);this.$player.removeClass(Q).empty()},full:function(){var Ah=this.options;var Ai=this.$image;var Ag=this.$list;if(!this.isShown||this.isPlayed||this.isFulled||!Ah.inline){return}this.isFulled=true;this.$body.addClass(A);this.$button.addClass(G);if(Ah.transition){Ai.removeClass(S);Ag.removeClass(S)}this.$viewer.addClass(O).removeAttr("style").css("z-index",Ah.zIndex);this.initContainer();this.viewer=f.extend({},this.container);this.renderList();this.initImage(f.proxy(function(){this.renderImage(function(){if(Ah.transition){setTimeout(function(){Ai.addClass(S);Ag.addClass(S)},0)}})},this))},exit:function(){var Ah=this.options;var Ai=this.$image;var Ag=this.$list;if(!this.isFulled){return}this.isFulled=false;this.$body.removeClass(A);this.$button.removeClass(G);if(Ah.transition){Ai.removeClass(S);Ag.removeClass(S)}this.$viewer.removeClass(O).css("z-index",Ah.zIndexInline);this.viewer=f.extend({},this.parent);this.renderViewer();this.renderList();this.initImage(f.proxy(function(){this.renderImage(function(){if(Ah.transition){setTimeout(function(){Ai.addClass(S);Ag.addClass(S)},0)}})},this))},tooltip:function(){var Ai=this.options;var Ag=this.$tooltip;var Ah=this.image;var Aj=[Q,L,S].join(" ");if(!this.isViewed||this.isPlayed||!Ai.tooltip){return}Ag.text(z(Ah.ratio*100)+"%");if(!this.tooltiping){if(Ai.transition){if(this.fading){Ag.trigger(d)}Ag.addClass(Aj);J(Ag[0]);Ag.addClass(m)}else{Ag.addClass(Q)}}else{clearTimeout(this.tooltiping)}this.tooltiping=setTimeout(f.proxy(function(){if(Ai.transition){Ag.one(d,f.proxy(function(){Ag.removeClass(Aj);this.fading=false},this)).removeClass(m);this.fading=true}else{Ag.removeClass(Q)}this.tooltiping=false},this),1000)},toggle:function(){if(this.image.ratio===1){this.zoomTo(this.initialImage.ratio,true)}else{this.zoomTo(1,true)}},reset:function(){if(this.isViewed&&!this.isPlayed){this.image=f.extend({},this.initialImage);this.renderImage()}},update:function(){var Ah=this.$element;var Ag=this.$images;var Ai=[];var Aj;if(this.isImg){if(!Ah.parent().length){return this.destroy()}}else{this.$images=Ag=Ah.find(this.options.selectorImg);this.length=Ag.length}if(this.isBuilt){f.each(this.$items,function(Ak){var Am=f(this).find("img")[0];var Al=Ag[Ak];if(Al){if(Al.src!==Am.src){Ai.push(Ak)}}else{Ai.push(Ak)}});this.$list.width("auto");this.initList();if(this.isShown){if(this.length){if(this.isViewed){Aj=f.inArray(this.index,Ai);if(Aj>=0){this.isViewed=false;this.view(Aa(this.index-(Aj+1),0))}else{this.$items.eq(this.index).addClass(Ad)}}}else{this.$image=null;this.isViewed=false;this.index=0;this.image=null;this.$canvas.empty();this.$title.empty()}}}},destroy:function(){var Ag=this.$element;if(this.options.inline){this.unbind()}else{if(this.isShown){this.unbind()}Ag.off(w,this.start)}this.unbuild();Ag.removeData(Y)},trigger:function(Ag,Ai){var Ah=f.Event(Ag,Ai);this.$element.trigger(Ah);return Ah},shown:function(){var Ag=this.options;this.transitioning=false;this.isFulled=true;this.isShown=true;this.isVisible=true;this.render();this.bind();if(f.isFunction(Ag.shown)){this.$element.one(Af,Ag.shown)}this.trigger(Af)},hidden:function(){var Ag=this.options;this.transitioning=false;this.isViewed=false;this.isFulled=false;this.isShown=false;this.isVisible=false;this.unbind();this.$body.removeClass(A);this.$viewer.addClass(k);this.resetList();this.resetImage();if(f.isFunction(Ag.hidden)){this.$element.one(y,Ag.hidden)}this.trigger(y)},requestFullscreen:function(){var Ag=document.documentElement;if(this.isFulled&&!document.fullscreenElement&&!document.mozFullScreenElement&&!document.webkitFullscreenElement&&!document.msFullscreenElement){if(Ag.requestFullscreen){Ag.requestFullscreen()}else{if(Ag.msRequestFullscreen){Ag.msRequestFullscreen()}else{if(Ag.mozRequestFullScreen){Ag.mozRequestFullScreen()}else{if(Ag.webkitRequestFullscreen){Ag.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}}}}}},exitFullscreen:function(){if(this.isFulled){if(document.exitFullscreen){document.exitFullscreen()}else{if(document.msExitFullscreen){document.msExitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitExitFullscreen){document.webkitExitFullscreen()}}}}}},change:function(Ai){var Ag=this.endX-this.startX;var Ah=this.endY-this.startY;switch(this.action){case"move":this.move(Ag,Ah);break;case"zoom":this.zoom(function(An,Ao,Aj,Ak){var Am=u(An*An+Ao*Ao);var Al=u(Aj*Aj+Ak*Ak);return(Al-Am)/Am}(p(this.startX-this.startX2),p(this.startY-this.startY2),p(this.endX-this.endX2),p(this.endY-this.endY2)),false,Ai);this.startX2=this.endX2;this.startY2=this.endY2;break;case"switch":this.action="switched";if(p(Ag)>p(Ah)){if(Ag>1){this.prev()}else{if(Ag<-1){this.next()}}}break}this.startX=this.endX;this.startY=this.endY},isSwitchable:function(){var Ag=this.image;var Ah=this.viewer;return(Ag.left>=0&&Ag.top>=0&&Ag.width<=Ah.width&&Ag.height<=Ah.height)}};h.DEFAULTS={inline:false,button:true,navbar:true,title:true,toolbar:true,tooltip:true,movable:true,zoomable:true,rotatable:true,scalable:true,transition:true,fullscreen:true,keyboard:true,interval:5000,minWidth:200,minHeight:100,zoomRatio:0.1,minZoomRatio:0.01,maxZoomRatio:100,zIndex:2015,zIndexInline:0,parentElement:"body",selectorImg:"img",url:"src",build:null,built:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null};h.setDefaults=function(Ag){f.extend(h.DEFAULTS,Ag)};h.TEMPLATE=('<div class="viewer-container"><div class="viewer-canvas"></div><div class="viewer-footer"><div class="viewer-title"></div><ul class="viewer-toolbar"><li title="上一幅" class="viewer-prev" data-action="prev"></li><li title="1:1" class="viewer-one-to-one" data-action="one-to-one"></li><li title="向右旋转" class="viewer-reset" data-action="rotate-right"></li><li title="放大图片" class="viewer-zoom-in" data-action="zoom-in"></li><li title="缩小图片" class="viewer-zoom-out" data-action="zoom-out"></li><li title="下一幅" class="viewer-next" data-action="next"></li></ul><div class="viewer-navbar"><ul class="viewer-list"></ul></div></div><div class="viewer-tooltip"></div><div class="viewer-button" data-action="mix"></div><div class="viewer-player"></div></div>');h.other=f.fn.viewer;f.fn.viewer=function(Ah){var Ai=P(arguments,1);var Ag;this.each(function(){var Aj=f(this);var Al=Aj.data(Y);var Ak;if(!Al){if(/destroy|hide|exit|stop|reset/.test(Ah)){return}Aj.data(Y,(Al=new h(this,Ah)))}if(o(Ah)&&f.isFunction(Ak=Al[Ah])){Ag=Ak.apply(Al,Ai)}});return t(Ag)?this:Ag};f.fn.viewer.Constructor=h;f.fn.viewer.setDefaults=h.setDefaults;f.fn.viewer.noConflict=function(){f.fn.viewer=h.other;return this}});